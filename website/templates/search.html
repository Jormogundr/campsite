{% extends "base.html" %} {% block title %}Search{% endblock %} {% block content%}
<body>
    <link rel="stylesheet" href="/static/styles/search.css">
    <div class="search-container">
    <form method="POST" class="search-form">
        <div class="form-group">
            <label>Name</label>
            <input type="text" name="name" value="{{ request.form.get('name', '') }}" 
                   placeholder="Search campsites...">
        </div>

        <div class="form-group">
            <label>Style</label>
            <select name="campingStyle">
                <option value="">Any</option>
                {% for style in camping_styles %}
                <option value="{{ style }}" 
                        {% if request.form.get('campingStyle') == style %}selected{% endif %}>
                    {{ style }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label>Min Rating</label>
            <select name="minRating">
                <option value="">Any</option>
                {% for rating in range(1, 6) %}
                <option value="{{ rating }}"
                        {% if request.form.get('minRating')|float == rating %}selected{% endif %}>
                    {{ rating }}+ ★
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label>Amenities</label>
            <div class="checkbox-group">
                <label class="checkbox-item">
                    <input type="checkbox" name="potableWater" value="true"
                           {% if request.form.get('potableWater') %}checked{% endif %}>
                    Water
                </label>
                <label class="checkbox-item">
                    <input type="checkbox" name="electrical" value="true"
                           {% if request.form.get('electrical') %}checked{% endif %}>
                    Electric
                </label>
                <label class="checkbox-item">
                    <input type="checkbox" name="firePit" value="true"
                           {% if request.form.get('firePit') %}checked{% endif %}>
                    Fire Pit
                </label>
            </div>
        </div>

        <div class="form-group">
            <label>Type</label>
            <div class="checkbox-group">
                <label class="checkbox-item">
                    <input type="checkbox" name="backCountry" value="true"
                           {% if request.form.get('backCountry') %}checked{% endif %}>
                    Back Country
                </label>
                <label class="checkbox-item">
                    <input type="checkbox" name="permitRequired" value="true"
                           {% if request.form.get('permitRequired') %}checked{% endif %}>
                    Permit
                </label>
            </div>
        </div>

        <button type="submit" class="search-button">Search</button>
    </form>
</div>

{% if results %}
<table class="results-table">
    <thead>
        <tr>
            <th>Name</th>
            <th>Style</th>
            <th>Rating</th>
            <th>Amenities</th>
            <th>Type</th>
            <th>Submitted By</th>
        </tr>
    </thead>
    <tbody>
        {% for campsite in results %}
        <tr>
            <td>
                <a href="{{ url_for('views.show_campsite', id=campsite.id) }}" class="campsite-link"> {{campsite.name}}</a>
            </td>
            <td>{{ campsite.campingStyle }}</td>
            <td class="rating">
                <span class="rating-number">{{ "%.1f"|format(campsite.rating) }}</span>
                <span class="rating-count">({{ campsite.numRatings }})</span>
            </td>
            <td>
                {% if campsite.potableWater %}<span class="checkmark">✓</span> Water{% endif %}
                {% if campsite.electrical %}<span class="checkmark">✓</span> Electric{% endif %}
                {% if campsite.firePit %}<span class="checkmark">✓</span> Fire{% endif %}
            </td>
            <td>
                {% if campsite.backCountry %}Back Country{% endif %}
                {% if campsite.permitRequired %}
                    {% if campsite.backCountry %}, {% endif %}
                    Permit Required
                {% endif %}
            </td>
            <td>{{ campsite.submittedBy }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% elif request.method == 'POST' %}
<p style="text-align: center; color: #666; padding: 20px;">
    No results found matching your criteria.
</p>
{% endif %}
</body>
{% endblock %}